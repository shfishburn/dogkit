---
import BaseLayout from "../../layouts/BaseLayout.astro";

export const prerender = false;

// Extract recipe ID from URL
const { id } = Astro.params;
---

<BaseLayout title="Recipe Detail" description="View a generated canine recipe." container="lg">
  <div class="rd__back">
    <a href="/recipes" class="button">‚Üê Back to recipes</a>
  </div>

  <div id="recipe-detail" data-recipe-id={id}>
    <!-- React island hydrates here -->
  </div>
</BaseLayout>

<script>
  import { createElement } from "react";
  import { createRoot } from "react-dom/client";
  import RecipeDetail from "../../components/RecipeDetail";

  const container = document.getElementById("recipe-detail");
  if (container) {
    const recipeId = container.dataset.recipeId ?? "";
    const root = createRoot(container);
    root.render(createElement(RecipeDetail, { recipeId }));

    window.addEventListener("astro:before-swap", () => root.unmount(), { once: true });
  }
</script>

<style>
  .rd__back {
    margin-bottom: var(--space-4);
  }
  :global(.rd__loading),
  :global(.rd__error) {
    text-align: center;
    padding: var(--space-8);
    color: var(--color-muted);
  }
  :global(.rd__hero--skeleton) {
    min-height: 300px;
    margin-bottom: var(--space-6);
  }
</style>
